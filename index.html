<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plataforma de Gestão</title>
    <!-- Frameworks e Ícones Externos -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Estilos Embutidos -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Estilo para a barra de rolagem */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* Estilo para o Stepper */
        .stepper-item {
            cursor: default; /* Impede que pareça clicável */
        }
    </style>
</head>
<body class="bg-gray-100">

    <div class="flex h-screen bg-gray-200">
        <!-- Menu Lateral -->
        <aside class="w-64 flex-shrink-0 bg-gray-800 text-white flex flex-col">
            <div class="h-16 flex items-center justify-center text-2xl font-bold border-b border-gray-700">
                Bancodoc
            </div>
            <nav class="flex-1 px-4 py-4">
                <ul>
                    <li>
                        <button id="menu-lancamento" class="w-full flex justify-between items-center py-2 px-4 rounded-lg hover:bg-gray-700 focus:outline-none">
                            <span class="font-medium"><i class="fas fa-rocket mr-3"></i>Lançamento</span>
                            <i id="arrow-lancamento" class="fas fa-chevron-down transform transition-transform duration-300"></i>
                        </button>
                        <ul id="submenu-lancamento" class="mt-2 ml-4 space-y-2">
                            <li>
                                <a href="#" class="block py-2 px-4 rounded-lg bg-blue-600 font-semibold">
                                    <i class="fas fa-user-tie mr-3"></i>Cadastro de Empregado
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </nav>
            <div class="p-4 border-t border-gray-700">
                <p class="text-sm text-center text-gray-400">&copy; 2024 - Todos os direitos reservados.</p>
            </div>
        </aside>

        <!-- Conteúdo Principal -->
        <main class="flex-1 flex flex-col overflow-hidden">
            <!-- TELA DE LISTAGEM (VIEW) -->
            <div id="view-lista" class="flex-1 flex flex-col">
                 <header class="h-16 bg-white shadow-md flex items-center justify-between px-6 flex-shrink-0">
                    <h1 class="text-2xl font-semibold text-gray-800">Cadastro de Empregado</h1>
                     <div class="flex items-center space-x-4">
                        <i class="fas fa-bell text-gray-600 hover:text-blue-600 cursor-pointer"></i>
                        <i class="fas fa-user-circle text-2xl text-gray-600 hover:text-blue-600 cursor-pointer"></i>
                    </div>
                </header>
                <div class="flex-1 p-6 overflow-y-auto">
                    <!-- Área de Filtros -->
                    <div class="bg-white p-6 rounded-lg shadow-md mb-6">
                        <h2 class="text-xl font-semibold mb-4 text-gray-700">Filtros de Busca</h2>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 items-end">
                            <div class="md:col-span-1">
                                <label for="filtro-cliente" class="block text-sm font-medium text-gray-600 mb-1">Cliente</label>
                                <select id="filtro-cliente" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="0">Selecione o Cliente</option>
                                </select>
                            </div>
                            <div class="md:col-span-1">
                                <label for="filtro-fornecedor" class="block text-sm font-medium text-gray-600 mb-1">Fornecedor</label>
                                <select id="filtro-fornecedor" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="0">Selecione o Fornecedor</option>
                                </select>
                            </div>
                            <div class="md:col-span-1">
                                <label for="filtro-unidade" class="block text-sm font-medium text-gray-600 mb-1">Unidade</label>
                                <select id="filtro-unidade" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                                    <option value="0">Selecione a Unidade</option>
                                </select>
                            </div>
                            <div class="md:col-span-1">
                                <button id="btn-buscar" class="bg-blue-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors w-full flex items-center justify-center">
                                    <i class="fas fa-search mr-2"></i>Buscar
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- Mensagem Inicial -->
                    <div id="mensagem-inicial" class="text-center py-10 px-6 bg-white rounded-lg shadow-md text-gray-500">
                        <i class="fas fa-filter text-4xl mb-4 text-gray-300"></i>
                        <p class="font-semibold">Por favor, selecione os filtros acima e clique em "Buscar" para carregar a lista de colaboradores.</p>
                    </div>
                    <!-- Lista de Empregados -->
                    <div id="container-lista" class="bg-white rounded-lg shadow-md hidden">
                        <div class="flex justify-between items-center p-6 border-b border-gray-200">
                            <h2 class="text-xl font-semibold text-gray-700">Lista de Colaboradores</h2>
                            <button id="btn-novo-colaborador" class="bg-blue-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center">
                                <i class="fas fa-plus mr-2"></i>Novo Colaborador
                            </button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome Completo</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">CPF</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Situação</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="tabela-empregados" class="bg-white divide-y divide-gray-200">
                                    <!-- Linhas serão inseridas via JS -->
                                </tbody>
                            </table>
                            <div id="sem-resultados" class="text-center py-10 text-gray-500 hidden">
                                <p>Nenhum colaborador encontrado para os filtros selecionados.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TELA DE FORMULÁRIO (VIEW) - MODIFICADA COM WIZARD -->
            <div id="view-formulario" class="hidden flex-1 flex flex-col">
                <header class="h-16 bg-white shadow-md flex items-center justify-between px-6 flex-shrink-0">
                    <h1 id="form-titulo" class="text-2xl font-semibold text-gray-800"></h1>
                    <button id="btn-voltar" class="bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300 flex items-center">
                        <i class="fas fa-arrow-left mr-2"></i> Voltar para a Lista
                    </button>
                </header>

                <div class="flex-1 p-6 overflow-y-auto">
                    <div class="bg-white p-8 rounded-lg shadow-md max-w-6xl mx-auto">
                        <!-- NAVEGAÇÃO DAS ETAPAS (WIZARD) -->
                        <div id="stepper-nav" class="flex border-b mb-8">
                            <div data-step="1" class="stepper-item active flex-1 text-center font-semibold p-4 border-b-2 border-blue-600 text-blue-600">
                                <i class="fas fa-user mr-2 hidden sm:inline"></i>Dados Pessoais
                            </div>
                            <div data-step="2" class="stepper-item flex-1 text-center font-semibold p-4 text-gray-500">
                                <i class="fas fa-file-contract mr-2 hidden sm:inline"></i>Contratuais
                            </div>
                            <div data-step="3" class="stepper-item flex-1 text-center font-semibold p-4 text-gray-500">
                                <i class="fas fa-tasks mr-2 hidden sm:inline"></i>Atividades
                            </div>
                             <div data-step="4" class="stepper-item flex-1 text-center font-semibold p-4 text-gray-500">
                                <i class="fas fa-check-circle mr-2 hidden sm:inline"></i>Revisão
                            </div>
                        </div>

                        <form id="form-empregado" class="space-y-6">
                            <input type="hidden" id="empregado-id">

                            <!-- ETAPA 1: DADOS PESSOAIS -->
                            <div id="step-1" class="form-step">
                                <h4 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4">Dados Pessoais e Documentos</h4>
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-x-6 gap-y-4">
                                    <div class="md:col-span-2">
                                        <label for="nome" class="block text-sm font-medium text-gray-700">Nome Civil</label>
                                        <input type="text" id="nome" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div class="md:col-span-2 flex items-end pb-2">
                                         <input type="checkbox" id="nome-social-check" class="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500">
                                         <label for="nome-social-check" class="ml-2 block text-sm text-gray-900">Utilizar Nome Social</label>
                                    </div>
                                    <div>
                                        <label for="pais-contratacao" class="block text-sm font-medium text-gray-700">País de Contratação</label>
                                        <select id="pais-contratacao" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>Brasil</option></select>
                                    </div>
                                    <div>
                                        <label for="cpf" class="block text-sm font-medium text-gray-700">CPF</label>
                                        <input type="text" id="cpf" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500" placeholder="000.000.000-00">
                                    </div>
                                    <div>
                                        <label for="rg" class="block text-sm font-medium text-gray-700">RG</label>
                                        <input type="text" id="rg" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="data-expedicao-rg" class="block text-sm font-medium text-gray-700">Data Expedição (RG)</label>
                                        <input type="date" id="data-expedicao-rg" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="orgao-emissor" class="block text-sm font-medium text-gray-700">Órgão Emissor</label>
                                        <input type="text" id="orgao-emissor" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="ctps" class="block text-sm font-medium text-gray-700">CTPS</label>
                                        <input type="text" id="ctps" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="pis" class="block text-sm font-medium text-gray-700">PIS</label>
                                        <input type="text" id="pis" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="data-nascimento" class="block text-sm font-medium text-gray-700">Data de Nascimento</label>
                                        <input type="date" id="data-nascimento" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div class="md:col-span-2">
                                        <label for="nome-mae" class="block text-sm font-medium text-gray-700">Nome da Mãe</label>
                                        <input type="text" id="nome-mae" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="escolaridade" class="block text-sm font-medium text-gray-700">Escolaridade</label>
                                        <select id="escolaridade" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>Ensino Médio Completo</option><option>Superior Incompleto</option><option>Superior Completo</option></select>
                                    </div>
                                    <div>
                                        <label for="cidade-residencia" class="block text-sm font-medium text-gray-700">Cidade de Residência</label>
                                        <input type="text" id="cidade-residencia" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="estado-residencia" class="block text-sm font-medium text-gray-700">Estado</label>
                                        <select id="estado-residencia" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>São Paulo</option><option>Rio de Janeiro</option><option>Minas Gerais</option></select>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ETAPA 2: INFORMAÇÕES CONTRATUAIS -->
                            <div id="step-2" class="form-step hidden">
                                <h4 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4">Informações Contratuais</h4>
                                <div class="grid grid-cols-1 md:grid-cols-4 gap-x-6 gap-y-4">
                                     <div>
                                        <label for="matricula" class="block text-sm font-medium text-gray-700">Matrícula</label>
                                        <input type="text" id="matricula" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="tipo-vinculo" class="block text-sm font-medium text-gray-700">Tipo de Vínculo</label>
                                        <select id="tipo-vinculo" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>Consolidação das Leis Trabalhistas</option></select>
                                    </div>
                                    <div>
                                        <label for="tipo-contratacao" class="block text-sm font-medium text-gray-700">Tipo de Contratação</label>
                                        <select id="tipo-contratacao" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>CLT</option><option>PJ</option><option>Estágio</option></select>
                                    </div>
                                    <div>
                                        <label for="contrato" class="block text-sm font-medium text-gray-700">Contrato</label>
                                        <input type="text" id="contrato" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="funcao" class="block text-sm font-medium text-gray-700">Função</label>
                                        <input type="text" id="funcao" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="area" class="block text-sm font-medium text-gray-700">Área</label>
                                        <select id="area" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>Tecnologia</option><option>Recursos Humanos</option></select>
                                    </div>
                                    <div>
                                        <label for="gerencia" class="block text-sm font-medium text-gray-700">Gerência</label>
                                        <select id="gerencia" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>Desenvolvimento</option><option>Operações</option></select>
                                    </div>
                                    <div>
                                        <label for="salario" class="block text-sm font-medium text-gray-700">Salário</label>
                                        <input type="number" id="salario" step="0.01" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500" placeholder="Ex: 2500.00">
                                    </div>
                                    <div>
                                        <label for="data-admissao" class="block text-sm font-medium text-gray-700">Data de Admissão</label>
                                        <input type="date" id="data-admissao" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="motivo-admissao" class="block text-sm font-medium text-gray-700">Motivo da Admissão</label>
                                        <select id="motivo-admissao" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>Primeiro Emprego</option><option>Substituição</option></select>
                                    </div>
                                    <div>
                                        <label for="data-demissao" class="block text-sm font-medium text-gray-700">Data de Demissão</label>
                                        <input type="date" id="data-demissao" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <div>
                                        <label for="motivo-demissao" class="block text-sm font-medium text-gray-700">Motivo da Demissão</label>
                                        <select id="motivo-demissao" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>Pedido de Demissão</option><option>Justa Causa</option></select>
                                    </div>
                                    <div>
                                        <label for="carga-horaria" class="block text-sm font-medium text-gray-700">Carga Horária</label>
                                        <select id="carga-horaria" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>220h</option><option>180h</option></select>
                                    </div>
                                    <div>
                                        <label for="dependentes" class="block text-sm font-medium text-gray-700">Dependentes</label>
                                        <select id="dependentes" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>0</option><option>1</option><option>2</option></select>
                                    </div>
                                    <div>
                                        <label for="status" class="block text-sm font-medium text-gray-700">Status</label>
                                        <select id="status" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                            <option value="Ativo">Ativo</option>
                                            <option value="Inativo">Inativo</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <!-- ETAPA 3: ATIVIDADES -->
                            <div id="step-3" class="form-step hidden">
                                <h4 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4">Atividades Executadas</h4>
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-x-6 items-end bg-gray-50 p-4 rounded-md border">
                                    <div class="md:col-span-1">
                                        <label for="atividade-select" class="block text-sm font-medium text-gray-700">Atividades</label>
                                        <select id="atividade-select" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500"><option>Análise de Requisitos</option><option>Desenvolvimento de API</option><option>Testes Unitários</option></select>
                                    </div>
                                    <div>
                                        <label for="atividade-data-inicio" class="block text-sm font-medium text-gray-700">Data Início</label>
                                        <input type="date" id="atividade-data-inicio" class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 focus:ring-blue-500 focus:border-blue-500">
                                    </div>
                                    <button type="button" id="btn-incluir-atividade" class="bg-gray-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-gray-700 transition-colors w-full md:w-auto">Incluir</button>
                                </div>
                                <div id="lista-atividades" class="mt-4">
                                    <!-- Atividades serão listadas aqui -->
                                </div>
                            </div>
                            
                            <!-- ETAPA 4: VINCULAÇÃO E REVISÃO -->
                            <div id="step-4" class="form-step hidden">
                                <div class="bg-gray-50 p-4 rounded-lg border mb-6">
                                    <h4 class="font-semibold text-gray-600 mb-2">Vinculação</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                           <label for="modal-cliente" class="block text-sm font-medium text-gray-700">Cliente</label>
                                           <select id="modal-cliente" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 bg-gray-200" disabled></select>
                                        </div>
                                        <div>
                                           <label for="modal-fornecedor" class="block text-sm font-medium text-gray-700">Fornecedor</label>
                                           <select id="modal-fornecedor" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 bg-gray-200" disabled></select>
                                        </div>
                                        <div>
                                           <label for="modal-unidade" class="block text-sm font-medium text-gray-700">Unidade</label>
                                           <select id="modal-unidade" required class="mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-2 bg-gray-200" disabled></select>
                                        </div>
                                    </div>
                                </div>
                                <div id="review-section">
                                    <h4 class="text-lg font-semibold text-gray-700 border-b pb-2 mb-4">Revise as Informações</h4>
                                    <div id="review-content" class="space-y-2 text-sm text-gray-700">
                                        <!-- Resumo dos dados será inserido aqui via JS -->
                                    </div>
                                </div>
                            </div>
                            
                            <!-- BOTÕES DE NAVEGAÇÃO E AÇÕES -->
                            <div id="step-navigation" class="flex justify-between items-center pt-4 border-t mt-6">
                                <div>
                                    <button type="button" id="btn-excluir-formulario" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors hidden">
                                        <i class="fas fa-trash mr-2"></i>Excluir
                                    </button>
                                </div>
                                <div class="ml-auto flex items-center space-x-4">
                                    <button type="button" id="btn-prev" class="bg-gray-200 text-gray-800 px-6 py-2 rounded-lg hover:bg-gray-300">Anterior</button>
                                    <button type="button" id="btn-next" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700">Próximo</button>
                                    <button type="submit" id="btn-save" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 hidden">Salvar Colaborador</button>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- BANCO DE DADOS (SIMULADO) ---
            const clientes = [
                { id: 1, nome: "Tech Solutions S.A.", temPreCadastro: true },
                { id: 2, nome: "Inova Corp", temPreCadastro: false },
                { id: 3, nome: "Global Logistics", temPreCadastro: false }
            ];
            const fornecedores = [
                { id: 1, nome: "Alpha Recursos Humanos" },
                { id: 2, nome: "Beta Terceirização" },
                { id: 3, nome: "Gama Facilities" }
            ];
            const unidades = [
                { id: 1, nome: "Matriz São Paulo" },
                { id: 2, nome: "Filial Rio de Janeiro" },
                { id: 3, nome: "Centro de Distribuição Curitiba" }
            ];
            let empregados = [
                { id: 1, situacao: "Cadastrado", nome: "Ana Carolina", cpf: "111.222.333-44", status: "Ativo", clienteId: 1, fornecedorId: 1, unidadeId: 1, dataNascimento: "1990-05-15", rg: "12.345.678-9", nomeMae: "Maria Almeida", matricula: "1001", dataAdmissao: "2022-01-10", funcao: "Desenvolvedora Frontend", salario: 7500.00, tipoContratacao: "CLT", dataExpedicaoRg: "2010-01-05", orgaoEmissor: "SSP/SP", ctps: "1234567", pis: "123.45678.90-1", escolaridade: "Superior Completo", cidadeResidencia: "São Paulo", estadoResidencia: "São Paulo", tipoVinculo: "Consolidação das Leis Trabalhistas", contrato: "Contrato A", area: "Tecnologia", gerencia: "Desenvolvimento", motivoAdmissao: "Substituição", dataDemissao: "", motivoDemissao: "", cargaHoraria: "220h", dependentes: 0, atividades: [{nome: 'Desenvolvimento de API', data: '2023-01-15'}] },
                { id: 2, situacao: "Pré-cadastro", nome: "Bruno Costa", cpf: "222.333.444-55", status: "Ativo", clienteId: 1, fornecedorId: 1, unidadeId: 2, dataNascimento: "1988-11-20", rg: "23.456.789-0", nomeMae: "Joana Costa", matricula: "1002", dataAdmissao: "2021-11-15", funcao: "Analista de Sistemas", salario: 8200.00, tipoContratacao: "CLT", atividades: [] },
                { id: 3, situacao: "Cadastrado", nome: "Carlos Eduardo", cpf: "333.444.555-66", status: "Inativo", clienteId: 2, fornecedorId: 2, unidadeId: 1, dataNascimento: "1985-02-25", rg: "34.567.890-1", nomeMae: "Sandra Pereira", matricula: "2001", dataAdmissao: "2020-03-01", funcao: "Gerente de Projetos", salario: 12500.00, tipoContratacao: "PJ", atividades: [] },
                { id: 4, situacao: "Aguardando", nome: "Daniela Ferreira", cpf: "444.555.666-77", status: "Ativo", clienteId: 1, fornecedorId: 3, unidadeId: 3, dataNascimento: "1995-09-10", rg: "45.678.901-2", nomeMae: "Beatriz Ferreira", matricula: "3001", dataAdmissao: "2023-05-20", funcao: "Analista de RH", salario: 4800.00, tipoContratacao: "CLT", atividades: [] },
                { id: 5, situacao: "Cadastrado", nome: "Eduardo Martins", cpf: "555.666.777-88", status: "Ativo", clienteId: 2, fornecedorId: 2, unidadeId: 1, dataNascimento: "1992-07-30", rg: "56.789.012-3", nomeMae: "Clara Martins", matricula: "1003", dataAdmissao: "2022-06-01", funcao: "Desenvolvedor Backend", salario: 7800.00, tipoContratacao: "CLT", atividades: [] },
            ];

            // --- SELETORES DO DOM ---
            const viewLista = document.getElementById('view-lista');
            const viewFormulario = document.getElementById('view-formulario');
            const filtroCliente = document.getElementById('filtro-cliente');
            const filtroFornecedor = document.getElementById('filtro-fornecedor');
            const filtroUnidade = document.getElementById('filtro-unidade');
            const tabelaEmpregados = document.getElementById('tabela-empregados');
            const semResultados = document.getElementById('sem-resultados');
            const containerLista = document.getElementById('container-lista');
            const mensagemInicial = document.getElementById('mensagem-inicial');
            const btnBuscar = document.getElementById('btn-buscar');
            const formTitulo = document.getElementById('form-titulo');
            const formEmpregado = document.getElementById('form-empregado');
            const empregadoIdInput = document.getElementById('empregado-id');
            const modalClienteSelect = document.getElementById('modal-cliente');
            const modalFornecedorSelect = document.getElementById('modal-fornecedor');
            const modalUnidadeSelect = document.getElementById('modal-unidade');
            const btnNovoColaborador = document.getElementById('btn-novo-colaborador');
            const btnVoltar = document.getElementById('btn-voltar');
            const btnExcluirFormulario = document.getElementById('btn-excluir-formulario');
            const btnIncluirAtividade = document.getElementById('btn-incluir-atividade');
            const listaAtividadesContainer = document.getElementById('lista-atividades');
            
            // --- SELETORES PARA O WIZARD ---
            const stepperItems = document.querySelectorAll('.stepper-item');
            const formSteps = document.querySelectorAll('.form-step');
            const btnPrev = document.getElementById('btn-prev');
            const btnNext = document.getElementById('btn-next');
            const btnSave = document.getElementById('btn-save');
            const reviewContent = document.getElementById('review-content');

            let atividadesTemporarias = [];
            let currentStep = 1; 
            const totalSteps = formSteps.length;

            // --- FUNÇÕES DE CONTROLE DE VIEW ---
            const showListView = () => {
                viewLista.classList.remove('hidden');
                viewFormulario.classList.add('hidden');
            };
            const showFormView = () => {
                viewLista.classList.add('hidden');
                viewFormulario.classList.remove('hidden');
            };

            // --- FUNÇÃO: ATUALIZAR ETAPAS (WIZARD) ---
            const updateStepView = () => {
                if(currentStep === totalSteps) {
                    buildReview();
                }

                formSteps.forEach(step => step.classList.add('hidden'));
                document.getElementById(`step-${currentStep}`).classList.remove('hidden');

                stepperItems.forEach((item) => {
                    const step = parseInt(item.dataset.step);
                    if (step === currentStep) {
                        item.classList.add('active', 'border-blue-600', 'text-blue-600');
                        item.classList.remove('text-gray-500', 'border-transparent');
                    } else {
                        item.classList.remove('active', 'border-blue-600', 'text-blue-600');
                        item.classList.add('text-gray-500', 'border-transparent');
                    }
                });

                btnPrev.classList.toggle('hidden', currentStep === 1);
                btnNext.classList.toggle('hidden', currentStep === totalSteps);
                btnSave.classList.toggle('hidden', currentStep !== totalSteps);
            };

            // --- FUNÇÃO: VALIDAR ETAPA ATUAL ---
            const validateStep = (step) => {
                const currentStepElement = document.getElementById(`step-${step}`);
                const inputs = currentStepElement.querySelectorAll('input[required], select[required]');
                let isValid = true;
                inputs.forEach(input => {
                    input.classList.remove('border-red-500');
                    if (!input.value || input.value === "0") {
                        isValid = false;
                        input.classList.add('border-red-500');
                    }
                });
                if (!isValid) {
                    alert('Por favor, preencha todos os campos obrigatórios.');
                }
                return isValid;
            };

            // --- FUNÇÃO: CONSTRUIR RESUMO PARA REVISÃO ---
            const buildReview = () => {
                const formData = new FormData(formEmpregado);
                const data = Object.fromEntries(formData.entries());

                // Coletando dados dos selects também
                data.nome = document.getElementById('nome').value;
                data.cpf = document.getElementById('cpf').value;
                data.funcao = document.getElementById('funcao').value;
                data.dataAdmissao = document.getElementById('data-admissao').value;
                data.salario = document.getElementById('salario').value;


                reviewContent.innerHTML = `
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <p><strong>Nome:</strong> ${data.nome || 'Não preenchido'}</p>
                        <p><strong>CPF:</strong> ${data.cpf || 'Não preenchido'}</p>
                        <p><strong>Função:</strong> ${data.funcao || 'Não preenchido'}</p>
                        <p><strong>Data de Admissão:</strong> ${data.dataAdmissao ? new Date(data.dataAdmissao + 'T00:00:00').toLocaleDateString('pt-BR') : 'Não preenchido'}</p>
                        <p><strong>Salário:</strong> R$ ${parseFloat(data.salario || 0).toFixed(2).replace('.',',')}</p>
                    </div>
                `;
            };


            // --- FUNÇÕES GERAIS ---
            const popularSelect = (selectElement, items, defaultOptionText) => {
                selectElement.innerHTML = `<option value="0">${defaultOptionText}</option>`;
                items.forEach(item => {
                    selectElement.innerHTML += `<option value="${item.id}">${item.nome}</option>`;
                });
            };
            
            const getSituacaoBadge = (situacao) => {
                switch (situacao) {
                    case 'Pré-cadastro': return 'bg-yellow-100 text-yellow-800';
                    case 'Cadastrado': return 'bg-green-100 text-green-800';
                    case 'Aguardando': return 'bg-blue-100 text-blue-800';
                    default: return 'bg-gray-100 text-gray-800';
                }
            };

            const renderizarTabela = () => {
                mensagemInicial.classList.add('hidden');
                containerLista.classList.remove('hidden');
                const clienteId = parseInt(filtroCliente.value);
                const fornecedorId = parseInt(filtroFornecedor.value);
                const unidadeId = parseInt(filtroUnidade.value);
                const empregadosFiltrados = empregados.filter(e => 
                    (clienteId === e.clienteId) &&
                    (fornecedorId === e.fornecedorId) &&
                    (unidadeId === e.unidadeId)
                );
                tabelaEmpregados.innerHTML = '';
                semResultados.classList.toggle('hidden', empregadosFiltrados.length > 0);
                empregadosFiltrados.forEach(e => {
                    const statusClass = e.status === 'Ativo' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800';
                    const situacaoClass = getSituacaoBadge(e.situacao);
                    const row = `
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${e.nome}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${e.cpf}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${situacaoClass}">${e.situacao}</span></td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm"><span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">${e.status}</span></td>
                            <td class="px-6 py-4 whitespace-nowrap text-center text-sm font-medium">
                                <button class="btn-editar text-blue-600 hover:text-blue-900" data-id="${e.id}"><i class="fas fa-edit"></i></button>
                            </td>
                        </tr>
                    `;
                    tabelaEmpregados.innerHTML += row;
                });
            };

            const renderizarAtividades = () => {
                listaAtividadesContainer.innerHTML = '';
                if (atividadesTemporarias.length === 0) {
                    listaAtividadesContainer.innerHTML = '<p class="text-sm text-gray-500 text-center">Nenhuma atividade incluída.</p>';
                    return;
                }
                const table = document.createElement('table');
                table.className = 'min-w-full divide-y divide-gray-200';
                table.innerHTML = `
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase">Atividade</th>
                            <th class="px-4 py-2 text-left text-xs font-medium text-gray-600 uppercase">Data Início</th>
                            <th class="px-4 py-2 text-center text-xs font-medium text-gray-600 uppercase">Ação</th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                    ${atividadesTemporarias.map((atv, index) => `
                        <tr>
                            <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-800">${atv.nome}</td>
                            <td class="px-4 py-2 whitespace-nowrap text-sm text-gray-500">${new Date(atv.data + 'T00:00:00').toLocaleDateString('pt-BR')}</td>
                            <td class="px-4 py-2 whitespace-nowrap text-center">
                                <button type="button" data-index="${index}" class="btn-remover-atividade text-red-500 hover:text-red-700"><i class="fas fa-trash"></i></button>
                            </td>
                        </tr>
                    `).join('')}
                    </tbody>
                `;
                listaAtividadesContainer.appendChild(table);
            };
            const adicionarAtividade = () => {
                const atividadeSelect = document.getElementById('atividade-select');
                const dataInput = document.getElementById('atividade-data-inicio');
                if (!dataInput.value) {
                    alert('Por favor, selecione a data de início da atividade.');
                    return;
                }
                atividadesTemporarias.push({
                    nome: atividadeSelect.options[atividadeSelect.selectedIndex].text,
                    data: dataInput.value
                });
                renderizarAtividades();
                dataInput.value = '';
            };
            const removerAtividade = (index) => {
                atividadesTemporarias.splice(index, 1);
                renderizarAtividades();
            };

            const abrirFormulario = (id = null) => {
                formEmpregado.reset();
                atividadesTemporarias = [];
                btnExcluirFormulario.classList.add('hidden');
                
                currentStep = 1;
                updateStepView();

                if (id) {
                    const empregado = empregados.find(e => e.id === id);
                    if(empregado.atividades) { atividadesTemporarias = [...empregado.atividades]; }
                    formTitulo.textContent = 'Editar Colaborador';
                    empregadoIdInput.value = empregado.id;
                    
                    document.getElementById('nome').value = empregado.nome || '';
                    document.getElementById('cpf').value = empregado.cpf || '';
                    document.getElementById('status').value = empregado.status || 'Ativo';
                    document.getElementById('pais-contratacao').value = empregado.paisContratacao || 'Brasil';
                    document.getElementById('data-nascimento').value = empregado.dataNascimento || '';
                    document.getElementById('rg').value = empregado.rg || '';
                    document.getElementById('data-expedicao-rg').value = empregado.dataExpedicaoRg || '';
                    document.getElementById('orgao-emissor').value = empregado.orgaoEmissor || '';
                    document.getElementById('ctps').value = empregado.ctps || '';
                    document.getElementById('pis').value = empregado.pis || '';
                    document.getElementById('nome-mae').value = empregado.nomeMae || '';
                    document.getElementById('escolaridade').value = empregado.escolaridade || 'Ensino Médio Completo';
                    document.getElementById('cidade-residencia').value = empregado.cidadeResidencia || '';
                    document.getElementById('estado-residencia').value = empregado.estadoResidencia || 'São Paulo';
                    document.getElementById('matricula').value = empregado.matricula || '';
                    document.getElementById('tipo-vinculo').value = empregado.tipoVinculo || 'Consolidação das Leis Trabalhistas';
                    document.getElementById('contrato').value = empregado.contrato || '';
                    document.getElementById('area').value = empregado.area || 'Tecnologia';
                    document.getElementById('gerencia').value = empregado.gerencia || 'Desenvolvimento';
                    document.getElementById('data-admissao').value = empregado.dataAdmissao || '';
                    document.getElementById('motivo-admissao').value = empregado.motivoAdmissao || 'Primeiro Emprego';
                    document.getElementById('data-demissao').value = empregado.dataDemissao || '';
                    document.getElementById('motivo-demissao').value = empregado.motivoDemissao || 'Pedido de Demissão';
                    document.getElementById('carga-horaria').value = empregado.cargaHoraria || '220h';
                    document.getElementById('dependentes').value = empregado.dependentes || 0;
                    document.getElementById('funcao').value = empregado.funcao || '';
                    document.getElementById('salario').value = empregado.salario || '';
                    document.getElementById('tipo-contratacao').value = empregado.tipoContratacao || 'CLT';

                    modalClienteSelect.value = empregado.clienteId;
                    modalFornecedorSelect.value = empregado.fornecedorId;
                    modalUnidadeSelect.value = empregado.unidadeId;
                    btnExcluirFormulario.classList.remove('hidden');
                } else {
                    formTitulo.textContent = 'Novo Colaborador';
                    empregadoIdInput.value = '';
                    modalClienteSelect.value = filtroCliente.value;
                    modalFornecedorSelect.value = filtroFornecedor.value;
                    modalUnidadeSelect.value = filtroUnidade.value;
                }
                renderizarAtividades();
                showFormView();
            };

            const salvarEmpregado = (e) => {
                e.preventDefault();
                const id = parseInt(empregadoIdInput.value);
                const clienteId = parseInt(modalClienteSelect.value);
                const clienteSelecionado = clientes.find(c => c.id === clienteId);

                const novoEmpregado = {
                    nome: document.getElementById('nome').value,
                    cpf: document.getElementById('cpf').value,
                    status: document.getElementById('status').value,
                    paisContratacao: document.getElementById('pais-contratacao').value,
                    dataNascimento: document.getElementById('data-nascimento').value,
                    rg: document.getElementById('rg').value,
                    dataExpedicaoRg: document.getElementById('data-expedicao-rg').value,
                    orgaoEmissor: document.getElementById('orgao-emissor').value,
                    ctps: document.getElementById('ctps').value,
                    pis: document.getElementById('pis').value,
                    nomeMae: document.getElementById('nome-mae').value,
                    escolaridade: document.getElementById('escolaridade').value,
                    cidadeResidencia: document.getElementById('cidade-residencia').value,
                    estadoResidencia: document.getElementById('estado-residencia').value,
                    matricula: document.getElementById('matricula').value,
                    tipoVinculo: document.getElementById('tipo-vinculo').value,
                    contrato: document.getElementById('contrato').value,
                    area: document.getElementById('area').value,
                    gerencia: document.getElementById('gerencia').value,
                    dataAdmissao: document.getElementById('data-admissao').value,
                    motivoAdmissao: document.getElementById('motivo-admissao').value,
                    dataDemissao: document.getElementById('data-demissao').value,
                    motivoDemissao: document.getElementById('motivo-demissao').value,
                    cargaHoraria: document.getElementById('carga-horaria').value,
                    dependentes: document.getElementById('dependentes').value,
                    funcao: document.getElementById('funcao').value,
                    salario: parseFloat(document.getElementById('salario').value) || 0,
                    tipoContratacao: document.getElementById('tipo-contratacao').value,
                    atividades: [...atividadesTemporarias],
                    clienteId: clienteId,
                    fornecedorId: parseInt(modalFornecedorSelect.value),
                    unidadeId: parseInt(modalUnidadeSelect.value)
                };

                if (id) {
                    const index = empregados.findIndex(e => e.id === id);
                    novoEmpregado.situacao = empregados[index].situacao; 
                    empregados[index] = { ...empregados[index], ...novoEmpregado, id: id };
                } else {
                    novoEmpregado.situacao = clienteSelecionado?.temPreCadastro ? 'Pré-cadastro' : 'Cadastrado';
                    novoEmpregado.id = empregados.length > 0 ? Math.max(...empregados.map(e => e.id)) + 1 : 1;
                    empregados.push(novoEmpregado);
                }
                renderizarTabela();
                showListView();
            };
            
            const excluirEmpregado = () => {
                const id = parseInt(empregadoIdInput.value);
                if (id && confirm('Tem certeza que deseja excluir este colaborador? Esta ação não pode ser desfeita.')) {
                    empregados = empregados.filter(e => e.id !== id);
                    renderizarTabela();
                    showListView();
                }
            };

            // --- EVENT LISTENERS ---
            btnBuscar.addEventListener('click', () => {
                if (parseInt(filtroCliente.value) === 0 || parseInt(filtroFornecedor.value) === 0 || parseInt(filtroUnidade.value) === 0) {
                    alert('Por favor, selecione um Cliente, um Fornecedor e uma Unidade para realizar a busca.');
                    return;
                }
                renderizarTabela();
            });

            btnNovoColaborador.addEventListener('click', () => abrirFormulario());
            btnVoltar.addEventListener('click', showListView);
            btnExcluirFormulario.addEventListener('click', excluirEmpregado);
            formEmpregado.addEventListener('submit', salvarEmpregado);
            btnIncluirAtividade.addEventListener('click', adicionarAtividade);
            listaAtividadesContainer.addEventListener('click', (e) => {
                const btnRemover = e.target.closest('.btn-remover-atividade');
                if (btnRemover) { removerAtividade(parseInt(btnRemover.dataset.index)); }
            });
            tabelaEmpregados.addEventListener('click', (e) => {
                const btnEditar = e.target.closest('.btn-editar');
                if (btnEditar) { abrirFormulario(parseInt(btnEditar.dataset.id)); }
            });

            // --- EVENT LISTENERS PARA O WIZARD ---
            btnNext.addEventListener('click', () => {
                if (validateStep(currentStep) && currentStep < totalSteps) {
                    currentStep++;
                    updateStepView();
                }
            });
            btnPrev.addEventListener('click', () => {
                if (currentStep > 1) {
                    currentStep--;
                    updateStepView();
                }
            });

            // --- INICIALIZAÇÃO ---
            popularSelect(filtroCliente, clientes, 'Selecione o Cliente');
            popularSelect(filtroFornecedor, fornecedores, 'Selecione o Fornecedor');
            popularSelect(filtroUnidade, unidades, 'Selecione a Unidade');
            
            const popularSelectVinculacao = (select, data) => {
                select.innerHTML = '';
                data.forEach(item => {
                   select.innerHTML += `<option value="${item.id}">${item.nome}</option>`;
                });
            };
            popularSelectVinculacao(modalClienteSelect, clientes);
            popularSelectVinculacao(modalFornecedorSelect, fornecedores);
            popularSelectVinculacao(modalUnidadeSelect, unidades);
        });
    </script>
</body>
</html>
